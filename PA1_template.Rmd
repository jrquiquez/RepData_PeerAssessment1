---
title: 'Reproducible Research: Peer Assessment 1'
author: "Jr Enriquez"
output:
  html_document:
    keep_md: yes
  pdf_document: default
---
## Setting up R
We're going to need some libraries in order to make this project easier. In this case we'll use dplyr
```{r,warning=FALSE, message=FALSE}
library(dplyr)
```


## Loading and preprocessing the data
The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.  

##### Variables

* steps: Number of steps taking in a 5-minute interval (missing values are coded as NA)

* date: The date on which the measurement was taken in YYYY-MM-DD format

* interval: Identifier for the 5-minute interval in which measurement was taken  

This code loads the csv into a data frame and converts the column classes
```{r}
dataset <- read.csv(file = "activity.csv",header = TRUE)
dataset$date <- as.Date(dataset$date,"%Y-%m-%d")
```

## What is mean total number of steps taken per day?
First we need to calc the total of steps for each day and put it into a graph for ease of understanding. 

```{r}
stepsday <- group_by(dataset,date)
stepsday<-summarise(stepsday,stepsday=sum(steps,na.rm = T))
hist(stepsday$stepsday, main = "Steps per Day",xlab = "Steps per day",ylab = "Frequency",col = "orange")
```

Once we calc the total steps per day we can use the proccessed data to calc the mean. 
```{r}
stepsdaymean <- mean(stepsday$stepsday)
stepsdaymedian <- median(stepsday$stepsday)
```

* #### **Mean of steps per day: `r round(stepsdaymean,digits=2)`**
* #### **Median of steps per day: `r stepsdaymedian`**
As you can see above the mean `r round(stepsdaymean,digits=2)` and the median `r stepsdaymedian` are pretty close. 

## What is the average daily activity pattern?
Sometimes it is convinient to see a timeseries in a graphic way. It is the easier way to visualize some patterns. 

```{r}
patternday <- group_by(dataset,interval)
patternday <- summarise(patternday,meaninterval=mean(steps,na.rm = T))
plot(patternday$interval,patternday$meaninterval,type = "l", main = "Daily Activity Pattern",xlab = "5 minute Interval", ylab = "Average of Steps Taken")
```

Now that we can see how the sample behaves during the day. We can answer the following question:  
**Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?** 
```{r}
maxsteps<-filter(patternday,meaninterval==max(meaninterval))
```
```{r echo=FALSE}
maxsteps[,1]<-gsub("([0-9]{1,2})([0-9]{2})", "\\1:\\2", maxsteps[,1])
```

#### In average the time with most steps is **`r maxsteps[,1]`** with **`r round(maxsteps[,2],digits=2)`** steps


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
